<!DOCTYPE html>

<html lang="en">
<head>
<title>異常抽水機回報</title>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body {
  font-size: calc(11px + (16 - 11) * ((100vw - 300px) / (1440 - 300)));
}

h2{
color:black;
text-align: center;
font-size: 150%;
}

th{
color:black;
font-size: 100%;
}

td{
color:black;
font-size: 80%;
}

.container-contact{
width:100%;
/*height:50%;*/
background-color:azure;
display: block;
margin-left: auto;
margin-right: auto;
}

.CheckSubmit{
text-align: center;
}

table.entryForm{
width:95%;
border: #f6bb9e 3px solid;
border-collapse: collapse;
margin-left: auto;
margin-right: auto;
}

.entryForm th{
width:6em;
background-color: bisque;
text-align: center;
vertical-align:middle;
} 

.btns {
width: 20%;
height: 40px;
margin: 0 1%;
padding: 2px;
/*
border:none;/*如果要無框*/
*/

}
.btns2 {
width:43%;
height: 40px;
margin: 0 1%;
padding: 2px;
/*
border:none;/*如果要無框*/
*/
 
}

</style>

</head>



<body>
    <div class="container-contact">
         <form id="myForm"> <!-- 表單 -->
        <h2>異常抽水機回報</h2>
            <div>
                 <table class="entryForm" border="1">
<!--tr新的一行-->
                    <tr>
                    <th> 機組名稱</th>
                    <td>
                    <input class="form-control" id="PumpName" placeholder="如：水利行政-01、水工科-01" type="text" style="resize:none;width:95%;height:10%;font-size:100%" required> <!--id就是用來抓資料用的，名字要固定好 -->
                    </td>
<!-- resize: none;阻止用户改变文本区域的大小。width: 95%;设置为父元素宽度的 95%。-->
                    </tr>
                    <tr>
                    <th>異常說明</th>
                    <td>
                    <textarea class="form-control" id="Comments" rows="4" cols="25" placeholder="如：操作人員反應抽水5分鐘後，自動停機，控制箱顯示：低機油位。" type="text"style="resize:none;width:95%;height:10%;font-size:100%" required></textarea>
                    </td>
                    </tr>
                    <tr>
                    <th>抽水機旁<br>是否有其他<br>抽水機組</th>
                    <td>
                   <!-- type="radio"就是單選的選填圈圈-->
                    <input type="radio" id="NearbyYesNo" value="是" style="font-size:100%">是
                    <input type="radio" id="NearbyYesNo" value="否" style="font-size:100%"checked>否
                    <br> <p style="font-size:70%">(如：水工科-97旁有水工科-99)</p>
                    </td>
                    </tr>
                    <tr>
                    <th>抽水機<br>前池(箱涵)<br>水位</th>
                    <td>
                   <!--id、name屬性需要同時存在，才能達到互斥，不然會沒有辦法用單選的方式 -->
                    <input type="radio" id="WaterLevel" name="WaterLevel" value="已有溢淹情勢" style="font-size:100%">已有溢淹情勢<br>
                    <input type="radio" id="WaterLevel" name="WaterLevel" value="水位8分滿以上" style="font-size:100%">水位8分滿以上<br>
                    <input type="radio" id="WaterLevel" name="WaterLevel" value="水位8分滿以下" style="font-size:100%">水位8分滿以下<br>
                    <input type="radio" id="WaterLevel" name="WaterLevel" value="無回報" style="font-size:100%"checked>無回報
                    </td>
                    </tr>
                    <tr>
                    <th>通報單位<br>(人員)</th>
                    <td>
                    <textarea class="form-control" id="Contact" placeholder="如：將軍操作吳ＯＯ 先生 (06)632-1234" type="text"style="resize:none;width:95%;height:60px;font-size:100%" required></textarea>
                    </td>
                    </tr>
                </table>
            </div>

                <script type="text/javascript">
                var userip;
                </script>
                <script type="text/javascript" id="UserIP" src="https://l2.io/ip.js?var=userip" ></script>
                <script type="text/javascript">
var formattedIP = "<span style='font-size: 20%; '>使用者IP:" + userip + "</span>";
                document.write(formattedIP);
                </script>
        <br>

            <div class="CheckSubmit">
                <div>
                <button class="btns" type="submit" id="submitButton" style="font-size:80%" >確認<br>送出</button>
                <button class="btns" type="reset" value="清除重填"style="font-size:80%">清除<br>重填</button>
                </div>


            </div>
        </form>

</div>

<!-- JavaScript程式 -->
    <script>
            // 抓輸入的值

            function getValues() {
            //javaScript寫完之後，要用分號隔開

            var PumpName = document.getElementById("PumpName"); //回去上面html的id=name去抓那個位置
            var Comments = document.getElementById("Comments");
            var Contact = document.getElementById("Contact");
            var NearbyYesNo;//核選方塊的特殊寫法
            var WaterLevel; //核選方塊的特殊寫法
            var CheckNearbyYesNo = document.querySelector('input[id="NearbyYesNo"]:checked');//要先看哪一個被勾到
            var CheckWaterLevel = document.querySelector('input[id="WaterLevel"]:checked'); //要先看哪一個被勾到
            NearbyYesNo=CheckNearbyYesNo.value;//把勾到的值來做回傳
            WaterLevel=CheckWaterLevel.value; //把勾到的值來做回傳
            var UserIP = userip;

//接下來，寫進去rowData這個矩陣裡面，之後回傳給資料庫
            var rowData = {
            PumpName: PumpName.value,
            Comments: Comments.value,
            NearbyYesNo: NearbyYesNo,//不用再寫value了(上面已經有了)
            WaterLevel: WaterLevel, //不用再寫value了(上面已經有了)
            Contact: Contact.value,
            UserIP:UserIP
            };//用矩陣的方式，後面記得有逗號

            //加上條件判斷式，避免沒有填寫就送單，用的方式是察看PumpName欄位的值有沒有長度
            if (PumpName.value.length === 0||Comments.value.length === 0||Contact.value.length === 0){
            alert("尚未完成表格");

            } else {

            // 上傳資料
            google.script.run.addData(rowData);//呼叫google script的'addData'程式碼
            // 清除表單上的資料
            document.getElementById("myForm").reset();
            alert(" \n 已收到！ \n\n 我們會儘快處理，謝謝回報。 \n\n 可由上方查看回報結果。"); // 完成後的訊息

            }
            };

            document.getElementById("submitButton").addEventListener("click", getValues);

    </script>

</body>

</html>



